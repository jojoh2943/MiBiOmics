ILE_CEI_OTUTable
metadata
rownames(metadata)
sampleAnnot
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
conds <- myAnnot$CONDITION
myAnnot
conds
?aldex.clr
library("ALDEx2")
library("treeio")
library("ggtree")
?aldex.clr
# LOADING DATA
source("/home/zoppi-j/Documents/myFunctions.R")
tree <- read.tree(file = "/home/zoppi-j/Documents/preprojet/microbiota/results/QIIME2_DEBLUR/tree.nwk")
taxAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/tax_annotation_DS.csv", row.names = 1, header = TRUE)
sampleAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/metadata_diversity_all.csv", sep=",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_CEI_2743_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_CEI_2595_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_CEI_1540_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_CEI_734_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_LUM_6885_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_LUM_5757_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_LUM_2800_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_LUM_1973_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable_CT <- CLD_CEI_OTUTable[,grepl("CT", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_CT <- CLP_CEI_OTUTable[,grepl("CT", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_CT <- ILE_CEI_OTUTable[,grepl("CT", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_CT <- CLD_LUM_OTUTable[,grepl("CT", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_CT <- CLP_LUM_OTUTable[,grepl("CT", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_CT <- ILE_LUM_OTUTable[,grepl("CT", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable_ST <- CLD_CEI_OTUTable[,grepl("ST", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_ST <- CLP_CEI_OTUTable[,grepl("ST", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_ST <- ILE_CEI_OTUTable[,grepl("ST", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_ST <- CLD_LUM_OTUTable[,grepl("ST", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_ST <- CLP_LUM_OTUTable[,grepl("ST", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_ST <- ILE_LUM_OTUTable[,grepl("ST", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable <- cbind(CLD_CEI_OTUTable_CT, CLD_CEI_OTUTable_ST)
CLP_CEI_OTUTable <- cbind(CLP_CEI_OTUTable_CT, CLP_CEI_OTUTable_ST)
ILE_CEI_OTUTable <- cbind(ILE_CEI_OTUTable_CT, ILE_CEI_OTUTable_ST)
CLD_LUM_OTUTable <- cbind(CLD_LUM_OTUTable_CT, CLD_LUM_OTUTable_ST)
CLP_LUM_OTUTable <- cbind(CLP_LUM_OTUTable_CT, CLP_LUM_OTUTable_ST)
ILE_LUM_OTUTable <- cbind(ILE_LUM_OTUTable_CT, ILE_LUM_OTUTable_ST)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
conds <- myAnnot$CONDITION
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
conds <- as.character(myAnnot$CONDITION)
conds
as.factor(conds)
conds <- as.factor(as.character(myAnnot$CONDITION))
conds
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
x.all <- data.frame(x.tt,x.effect)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
?aldex.plot
aldex.plot(x.all, type="MA", test="kruskal")
aldex.plot(x.all, type="MW", test="kruskal")
aldex.plot(x.all, type="MA", test="welch")
x.all
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
.tt <- aldex.ttest(x, conds, paired.test=TRUE)
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=TRUE)
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$we.eBH < 0.05 & x.all$wi.eBH < 0.05)
x.all
head(x.all)
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
x.all
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
found.by.all
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
found.by.one
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
x.all
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(CLP_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
CLP_CEI_OTUTable <- CLP_CEI_OTUTable[,order(colnames(CLP_CEI_OTUTable))]
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(CLP_CEI_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
found.by.one
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(CLD_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
CLD_CEI_OTUTable <- CLD_CEI_OTUTable[,order(colnames(CLD_CEI_OTUTable))]
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(CLD_CEI_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_LUM_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_LUM_OTUTable <- ILE_LUM_OTUTable[,order(colnames(ILE_LUM_OTUTable))]
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_LUM_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(CLP_LUM_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
CLP_LUM_OTUTable <- CLP_LUM_OTUTable[,order(colnames(CLP_LUM_OTUTable))]
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(CLP_LUM_OTUTable, conds, mc.samples=16, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=128, denom="all", verbose=TRUE)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=128, denom="all", verbose=TRUE)
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x, conds, paired.test=TRUE)
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=TRUE)
?aldex.ttest
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=FALSE)
x.tot.bis <- data.frame(x.tt,x.effect)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
x.tot.bis <- data.frame(x.tt,x.effect)
aldex.plot(x.tot.bis, type="MA", test="welch")
aldex.plot(x.tot.bis, type="MW", test="welch")
aldex.plot(x.tot.bis, type="MA", test="welch")
x.tot.bis
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=1000, denom="all", verbose=TRUE)
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=FALSE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.tot <- data.frame(x.kw,x.effect)
x.tot.bis <- data.frame(x.tt,x.effect)
aldex.plot(x.tot, type="MA", test="glm")
aldex.plot(x.tot, type="MW", test="glm")
aldex.plot(x.tot.bis, type="MA", test="welch")
aldex.plot(x.tot.bis, type="MW", test="welch")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
library("ALDEx2")
library("treeio")
library("ggtree")
# LOADING DATA
source("/home/zoppi-j/Documents/myFunctions.R")
tree <- read.tree(file = "/home/zoppi-j/Documents/preprojet/microbiota/results/QIIME2_DEBLUR/tree.nwk")
taxAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/tax_annotation_DS.csv", row.names = 1, header = TRUE)
sampleAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/metadata_diversity_all.csv", sep=",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_CEI_2743_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_CEI_2595_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_CEI_1540_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_CEI_734_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_LUM_6885_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_LUM_5757_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_LUM_2800_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_LUM_1973_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable_CT <- CLD_CEI_OTUTable[,grepl("CT", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_CT <- CLP_CEI_OTUTable[,grepl("CT", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_CT <- ILE_CEI_OTUTable[,grepl("CT", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_CT <- CLD_LUM_OTUTable[,grepl("CT", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_CT <- CLP_LUM_OTUTable[,grepl("CT", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_CT <- ILE_LUM_OTUTable[,grepl("CT", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable_ST <- CLD_CEI_OTUTable[,grepl("ST", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_ST <- CLP_CEI_OTUTable[,grepl("ST", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_ST <- ILE_CEI_OTUTable[,grepl("ST", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_ST <- CLD_LUM_OTUTable[,grepl("ST", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_ST <- CLP_LUM_OTUTable[,grepl("ST", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_ST <- ILE_LUM_OTUTable[,grepl("ST", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable <- cbind(CLD_CEI_OTUTable_CT, CLD_CEI_OTUTable_ST)
CLP_CEI_OTUTable <- cbind(CLP_CEI_OTUTable_CT, CLP_CEI_OTUTable_ST)
ILE_CEI_OTUTable <- cbind(ILE_CEI_OTUTable_CT, ILE_CEI_OTUTable_ST)
CLD_LUM_OTUTable <- cbind(CLD_LUM_OTUTable_CT, CLD_LUM_OTUTable_ST)
CLP_LUM_OTUTable <- cbind(CLP_LUM_OTUTable_CT, CLP_LUM_OTUTable_ST)
ILE_LUM_OTUTable <- cbind(ILE_LUM_OTUTable_CT, ILE_LUM_OTUTable_ST)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
ILE_CEI_OTUTable <- filtr_prev(ILE_CEI_OTUTable, 3, samples_are_rows = FALSE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=126, denom="all", verbose=TRUE)
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=FALSE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.tot <- data.frame(x.kw,x.effect)
x.tot.bis <- data.frame(x.tt,x.effect)
aldex.plot(x.tot, type="MA", test="glm")
aldex.plot(x.tot, type="MW", test="glm")
aldex.plot(x.tot.bis, type="MA", test="welch")
aldex.plot(x.tot.bis, type="MW", test="welch")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
ILE_CEI_OTUTable <- cbind(ILE_CEI_OTUTable_CT, ILE_CEI_OTUTable_ST)
rownames(ILE_CEI_OTUTable)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
ILE_CEI_OTUTable <- filtr_prev(ILE_CEI_OTUTable, 3, samples_are_rows = TRUE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=126, denom="all", verbose=TRUE)
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=FALSE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
ILE_CEI_OTUTable <- filtr_prev(ILE_CEI_OTUTable, 3, samples_are_rows = FALSE, percentage = FALSE)
ILE_CEI_OTUTable <- cbind(ILE_CEI_OTUTable_CT, ILE_CEI_OTUTable_ST)
ILE_CEI_OTUTable <- filtr_prev(ILE_CEI_OTUTable, 2, samples_are_rows = FALSE, percentage = FALSE)
# LOADING DATA
source("/home/zoppi-j/Documents/myFunctions.R")
tree <- read.tree(file = "/home/zoppi-j/Documents/preprojet/microbiota/results/QIIME2_DEBLUR/tree.nwk")
taxAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/tax_annotation_DS.csv", row.names = 1, header = TRUE)
sampleAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/metadata_diversity_all.csv", sep=",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_CEI_2743_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_CEI_2595_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_CEI_1540_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_CEI_734_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_LUM_6885_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_LUM_5757_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_LUM_2800_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_LUM_1973_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable_CT <- CLD_CEI_OTUTable[,grepl("CT", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_CT <- CLP_CEI_OTUTable[,grepl("CT", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_CT <- ILE_CEI_OTUTable[,grepl("CT", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_CT <- CLD_LUM_OTUTable[,grepl("CT", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_CT <- CLP_LUM_OTUTable[,grepl("CT", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_CT <- ILE_LUM_OTUTable[,grepl("CT", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable_ST <- CLD_CEI_OTUTable[,grepl("ST", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_ST <- CLP_CEI_OTUTable[,grepl("ST", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_ST <- ILE_CEI_OTUTable[,grepl("ST", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_ST <- CLD_LUM_OTUTable[,grepl("ST", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_ST <- CLP_LUM_OTUTable[,grepl("ST", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_ST <- ILE_LUM_OTUTable[,grepl("ST", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable <- cbind(CLD_CEI_OTUTable_CT, CLD_CEI_OTUTable_ST)
CLP_CEI_OTUTable <- cbind(CLP_CEI_OTUTable_CT, CLP_CEI_OTUTable_ST)
ILE_CEI_OTUTable <- cbind(ILE_CEI_OTUTable_CT, ILE_CEI_OTUTable_ST)
CLD_LUM_OTUTable <- cbind(CLD_LUM_OTUTable_CT, CLD_LUM_OTUTable_ST)
CLP_LUM_OTUTable <- cbind(CLP_LUM_OTUTable_CT, CLP_LUM_OTUTable_ST)
ILE_LUM_OTUTable <- cbind(ILE_LUM_OTUTable_CT, ILE_LUM_OTUTable_ST)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
ILE_CEI_OTUTable <- filtr_prev(ILE_CEI_OTUTable, 2, samples_are_rows = FALSE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=126, denom="all", verbose=TRUE)
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=FALSE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.tot <- data.frame(x.kw,x.effect)
x.tot.bis <- data.frame(x.tt,x.effect)
aldex.plot(x.tot, type="MA", test="glm")
aldex.plot(x.tot, type="MW", test="glm")
aldex.plot(x.tot.bis, type="MA", test="welch")
aldex.plot(x.tot.bis, type="MW", test="welch")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# LOADING DATA
source("/home/zoppi-j/Documents/myFunctions.R")
tree <- read.tree(file = "/home/zoppi-j/Documents/preprojet/microbiota/results/QIIME2_DEBLUR/tree.nwk")
taxAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/tax_annotation_DS.csv", row.names = 1, header = TRUE)
sampleAnnot <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/metadata_diversity_all.csv", sep=",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_CEI_2743_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_CEI_2595_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_CEI_1540_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_CEI_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_CEI_734_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLD_LUM_6885_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLP_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/CLP_LUM_5757_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
ILE_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/ILE_LUM_2800_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
JEJ_LUM_OTUTable <- read.csv("/home/zoppi-j/Documents/preprojet/microbiota/data/JEJ_LUM_1973_OTU_table_DS.csv", sep = ",", header = TRUE, row.names = 1)
CLD_CEI_OTUTable_CT <- CLD_CEI_OTUTable[,grepl("CT", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_CT <- CLP_CEI_OTUTable[,grepl("CT", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_CT <- ILE_CEI_OTUTable[,grepl("CT", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_CT <- CLD_LUM_OTUTable[,grepl("CT", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_CT <- CLP_LUM_OTUTable[,grepl("CT", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_CT <- ILE_LUM_OTUTable[,grepl("CT", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable_ST <- CLD_CEI_OTUTable[,grepl("ST", colnames(CLD_CEI_OTUTable))]
CLP_CEI_OTUTable_ST <- CLP_CEI_OTUTable[,grepl("ST", colnames(CLP_CEI_OTUTable))]
ILE_CEI_OTUTable_ST <- ILE_CEI_OTUTable[,grepl("ST", colnames(ILE_CEI_OTUTable))]
CLD_LUM_OTUTable_ST <- CLD_LUM_OTUTable[,grepl("ST", colnames(CLD_LUM_OTUTable))]
CLP_LUM_OTUTable_ST <- CLP_LUM_OTUTable[,grepl("ST", colnames(CLP_LUM_OTUTable))]
ILE_LUM_OTUTable_ST <- ILE_LUM_OTUTable[,grepl("ST", colnames(ILE_LUM_OTUTable))]
CLD_CEI_OTUTable <- cbind(CLD_CEI_OTUTable_CT, CLD_CEI_OTUTable_ST)
CLP_CEI_OTUTable <- cbind(CLP_CEI_OTUTable_CT, CLP_CEI_OTUTable_ST)
ILE_CEI_OTUTable <- cbind(ILE_CEI_OTUTable_CT, ILE_CEI_OTUTable_ST)
CLD_LUM_OTUTable <- cbind(CLD_LUM_OTUTable_CT, CLD_LUM_OTUTable_ST)
CLP_LUM_OTUTable <- cbind(CLP_LUM_OTUTable_CT, CLP_LUM_OTUTable_ST)
ILE_LUM_OTUTable <- cbind(ILE_LUM_OTUTable_CT, ILE_LUM_OTUTable_ST)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(ILE_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
ILE_CEI_OTUTable <- ILE_CEI_OTUTable[,order(colnames(ILE_CEI_OTUTable))]
ILE_CEI_OTUTable <- filtr_prev(ILE_CEI_OTUTable, 1, samples_are_rows = FALSE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=126, denom="all", verbose=TRUE)
# The next operation performs the Welch’s t and Wilcoxon rank test for the instance when there
# are only two conditions
x.tt <- aldex.ttest(x.all, conds, paired.test=FALSE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.tot <- data.frame(x.kw,x.effect)
x.tot.bis <- data.frame(x.tt,x.effect)
aldex.plot(x.tot, type="MA", test="glm")
aldex.plot(x.tot, type="MW", test="glm")
aldex.plot(x.tot.bis, type="MA", test="welch")
aldex.plot(x.tot.bis, type="MW", test="welch")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(CLP_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
CLP_CEI_OTUTable <- CLP_CEI_OTUTable[,order(colnames(CLP_CEI_OTUTable))]
CLP_CEI_OTUTable <- filtr_prev(CLP_CEI_OTUTable, 5, samples_are_rows = FALSE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(CLP_CEI_OTUTable, conds, mc.samples=1000, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.tot <- data.frame(x.kw,x.effect)
aldex.plot(x.tot, type="MA", test="glm")
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(ILE_CEI_OTUTable, conds, mc.samples=126, denom="iqlr", verbose=TRUE)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(CLP_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
CLP_CEI_OTUTable <- CLP_CEI_OTUTable[,order(colnames(CLP_CEI_OTUTable))]
CLP_CEI_OTUTable <- filtr_prev(CLP_CEI_OTUTable, 5, samples_are_rows = FALSE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(CLP_CEI_OTUTable, conds, mc.samples=128, denom="all", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(CLP_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
CLP_CEI_OTUTable <- CLP_CEI_OTUTable[,order(colnames(CLP_CEI_OTUTable))]
CLP_CEI_OTUTable <- filtr_prev(CLP_CEI_OTUTable, 5, samples_are_rows = FALSE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(CLP_CEI_OTUTable, conds, mc.samples=128, denom="iqlr", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
myAnnot <- sampleAnnot[which(rownames(sampleAnnot) %in% colnames(CLP_CEI_OTUTable)),]
myAnnot <- myAnnot[order(rownames(myAnnot)),]
CLP_CEI_OTUTable <- CLP_CEI_OTUTable[,order(colnames(CLP_CEI_OTUTable))]
CLP_CEI_OTUTable <- filtr_prev(CLP_CEI_OTUTable, 5, samples_are_rows = FALSE, percentage = FALSE)
conds <- as.factor(as.character(myAnnot$CONDITION))
# We recommend 128 or more mc.samples for the t-test, 1000 for a rigorous effect size calculation, and at # least 16 for ANOVA.
x.all <- aldex.clr(CLP_CEI_OTUTable, conds, mc.samples=128, denom="zeo", verbose=TRUE)
# perform the glm and Kruskal Wallace tests for one-way ANOVA of two or more conditions
x.kw <- aldex.kw(x.all)
# estimate effect size and the within and between condition values in the case of two conditions
x.effect <- aldex.effect(x.all, verbose=TRUE)
# We combine both results from the test and the effect size
x.all <- data.frame(x.kw,x.effect)
aldex.plot(x.all, type="MA", test="glm")
aldex.plot(x.all, type="MW", test="glm")
# identify which values are significant in both the kw and glm tests
found.by.all <- which(x.all$kw.eBH < 0.05 & x.all$glm.eBH < 0.05)
# identify which values are significant in both the kw and glm tests
found.by.one <- which(x.all$kw.eBH < 0.05 | x.all$glm.eBH < 0.05)
shiny::runApp('MiBiOmics_v2')
shiny::runApp('MiBiOmics_v2')
shiny::runApp('MiBiOmics_v2')
runApp('MiBiOmics_v2')
runApp('MiBiOmics_v2')
runApp('MiBiOmics_v2')
?pickSoftThreshold
runApp('MiBiOmics_v2')
runApp('MiBiOmics_v2')
shiny::runApp('MiBiOmics_v2')
runApp('MiBiOmics_v2')
shiny::runApp('MiBiOmics_v2')
